/*
 */

/* 
 * File:   C37_Buffer.h
 * Author: mcp
 *
 * Created on April 24, 2017, 12:51 AM
 */

#ifndef C37_BUFFER_H
#define C37_BUFFER_H

#define DEFAULT_BUFFER_LEN 1024

//namespace C37_Util {
    
class C37_Buffer {
public:
    C37_Buffer();
    virtual ~C37_Buffer();
    void setBytesReceived(unsigned int bytesReceived);
    int examineBuffer();
    int removeMsgFromBuffer();
    int removeC37MsgFromBuffer(uint8_t * dataBuf);
    int removeRawMsgFromBuffer(uint8_t * dataBuf);
    boost::asio::mutable_buffers_1 getBufferDesc();
    void init();
    unsigned int msgLenBytes;
    unsigned int msgType;
    /* C37 event used for development and testing 
    unsigned char * buffer = new unsigned char[82] {0xaa, 0x02, 0x00, 0x4a, 0x00, 0x01, 0x58, 0xf4,\
        0x32, 0xc9, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x42, 0xe8, 0xc4, 0x0f,\
        0x40, 0xb1, 0x05, 0x94, 0x3e, 0x4c, 0x33, 0x6e, 0x3f, 0x43, 0x77, 0xfb,\
        0x3d, 0x25, 0x0a, 0x96, 0x3f, 0x37, 0x8b, 0x37, 0x37, 0xc8, 0xf8, 0x63, 0x3f,\
        0x3d, 0x89, 0x56, 0x37, 0x2c, 0x78, 0x5e, 0x3f, 0x20, 0x5a, 0x92, 0x36, 0x7e,\
        0xcc, 0x81, 0x40, 0xdb, 0xac, 0x80, 0x42, 0x4d, 0x90, 0xa6, 0x9c, 0xb7,\
        0xc0, 0x45, 0x87, 0x94, 0xaa, 0x02, 0x00, 0x4a, 0x00, 0x01, 0x58, 0xf4};
     * */
    unsigned char buffer[DEFAULT_BUFFER_LEN];
    unsigned int maxBufferBytes = DEFAULT_BUFFER_LEN;
    unsigned int validBufferBytes;
    enum C37_Buf_STATE {unknownMsg, partialMsg, completeMsg} bufState;
    unsigned int msgCounter;
private:
};
//}

#endif /* C37_BUFFER_H */

